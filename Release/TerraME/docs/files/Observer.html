<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
    <title>Reference</title>
    <link rel="stylesheet" href="../luadoc.css" type="text/css" />
	<!--meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/-->
</head>

<body>
<div id="container">

<div id="product">
	<div id="product_logo"><img src='../img/terrame.png'/><br/></div>
	<div id="product_name"><big><b></b></big></div>
	<div id="product_description"></div>
</div> <!-- id="product" -->

<div id="main">

<div id="navigation">


<h1>TerraME</h1>
<ul>
	
	<li><a href="../index.html">Index</a></li>
	
</ul>


<!-- Module list -->



<!-- Types list -->

<h1>Types</h1>
<ul>

		<li>
			<a href="../files/Agent.html">Agent</a>
		</li>
		
	

		<li>
			<a href="../files/Automaton.html">Automaton</a>
		</li>
		
	

		<li>
			<a href="../files/Cell.html">Cell</a>
		</li>
		
	

		<li>
			<a href="../files/CellularSpace.html">CellularSpace</a>
		</li>
		
	

		<li>
			<a href="../files/Coord.html">Coord</a>
		</li>
		
	

		<li>
			<a href="../files/Environment.html">Environment</a>
		</li>
		
	

		<li>
			<a href="../files/Event.html">Event</a>
		</li>
		
	

		<li>
			<a href="../files/Flow.html">Flow</a>
		</li>
		
	

		<li>
			<a href="../files/Group.html">Group</a>
		</li>
		
	

		<li>
			<a href="../files/Jump.html">Jump</a>
		</li>
		
	

		<li>
			<a href="../files/Legend.html">Legend</a>
		</li>
		
	

		<li>
			<a href="../files/Neighborhood.html">Neighborhood</a>
		</li>
		
	

		<li><strong>Observer</strong></li>
		
	

		<li>
			<a href="../files/Random.html">Random</a>
		</li>
		
	

		<li>
			<a href="../files/SocialNetwork.html">SocialNetwork</a>
		</li>
		
	

		<li>
			<a href="../files/Society.html">Society</a>
		</li>
		
	

		<li>
			<a href="../files/State.html">State</a>
		</li>
		
	

		<li>
			<a href="../files/Timer.html">Timer</a>
		</li>
		
	

		<li>
			<a href="../files/Trajectory.html">Trajectory</a>
		</li>
		
	


</ul>


<!-- Files list -->

<h1>Files</h1>
<ul>




















		<li>
			<a href="../files/Utils.html">Utils</a>
		</li>
		
	

</ul>


</div> <!-- id="navigation" -->

<div id="content">

<h1><code>Observer



</code></h1>


<span class="description"></span>









<span class="description">Observer is the way to collect data from the objects of a model in order to save, to graphically plot them, or to send them to another computer. Observers can be created from any TerraME object that has a built-in function called notify(). This function needs to be called to update its observers because they are passive objects. Observers do not need to be put into an object to exist, as in the second example on the left side. Default values of observer types depend on the parameters. See table below for a description on how it works.</span>


	 
			<table class="param_tab">
			
				<tr>
					
							<th>
							Parameters, from higher to lower priority
							</th>
						
							<th>
							Default type
							</th>
						
				<tr>
					
							<td>
							file == "*.csv"
							</td>
						
							<td>
							logfile
							</td>
						
				<tr>
					
							<td>
							file ~= nil
							</td>
						
							<td>
							image
							</td>
						
				<tr>
					
							<td>
							host ~= nil or port ~= nil
							</td>
						
							<td>
							udpsender
							</td>
						
				<tr>
					
							<td>
							neighIndex ~= nil or neighType ~= nil
							</td>
						
							<td>
							neighborhood
							</td>
						
				<tr>
					
							<td>
							type(subject) == "Timer"
							</td>
						
							<td>
							scheduler
							</td>
						
				<tr>
					
							<td>
							type(subject) == "Event"
							</td>
						
							<td>
							table
							</td>
						
				<tr>
					
							<td>
							type(subject) == "CellularSpace"
							</td>
						
							<td>
							map
							</td>
						
				<tr>
					
							<td>
							type(subject) == "Trajectory"
							</td>
						
							<td>
							map
							</td>
						
				<tr>
					
							<td>
							type(observer) == "Observer" and type(subject) == "Cell"
							</td>
						
							<td>
							neighborhood
							</td>
						
				<tr>
					
							<td>
							type(subject) == "Cell"
							</td>
						
							<td>
							table
							</td>
						
				<tr>
					
							<td>
							type(subject) == "Automaton"
							</td>
						
							<td>
							map
							</td>
						
				<tr>
					
							<td>
							type(subject) == "Agent"
							</td>
						
							<td>
							statemachine
							</td>
						
				<tr>
					
							<td>
							type(subject) == "Society"
							</td>
						
							<td>
							map
							</td>
						
				<tr>
					
							<td>
							type(subject) == "Group"
							</td>
						
							<td>
							map
							</td>
						
				</tr>    
			</table>
		


<!-- Function parameters -->
  <h3>Parameters</h3>
<ul><span class="param">

    <li>
	  <strong>attributes</strong>: A vector of strings with the name of the attributes to be observed. If it is only a single value then it can also be described as a string.
    </li> 
    
  
    <li>
	  <strong>curveLabels</strong>: Vector of the same size of attributes that indicates the labels for each line of a chart. Default is the name of the attributes. 
    </li> 
    
  
    <li>
	  <strong>file</strong>: Name of the file to be saved. In the case of images, it represent the fixed part of the file name that will be concatenated with a timestamp and ".png". In the case of logfiles, it must be a file ending with ".csv". Default value is "result_" for image files and result_.csv for logfiles.
    </li> 
    
  
    <li>
	  <strong>host</strong>: A string or a vector of strings with host names for udpsenders.
    </li> 
    
  
    <li>
	  <strong>legends</strong>: A <a href=../files/Legend.html>Legend</a> or a vector of Legends to paint objects according to their properties.
    </li> 
    
  
    <li>
	  <strong>location</strong>: A <a href=../files/Cell.html>Cell</a> representing a location to observe an <a href=../files/Automaton.html>Automaton</a>.
    </li> 
    
  
    <li>
	  <strong>neighIndex</strong>: A string or a vector of strings representing the neighborhood indexes to be drawn by a neighborhood observer. Default is "1".
    </li> 
    
  
    <li>
	  <strong>neighType</strong>: One of three strings, "basic" (default), "color", or "width", for neighborhood observers. Basic type draws neighborhoods as lines with the same color and width. Color draws them using colors according to their weights. Width draws them with widths according to their weights. All them use the attribute width of Legends. The first two use it as width for all lines, while the last one interpolates the weights of the relations to draw widths between one pixel and the Legend width.
    </li> 
    
  
    <li>
	  <strong>observer</strong>: An Observer that will be used as background for drawing properties of observed objects that canxnot be drawn alone.
    </li> 
    
  
    <li>
	  <strong>port</strong>: A string or a vector of strings with ports for the respective host names to be used by udpsenders.
    </li> 
    
  
    <li>
	  <strong>separator</strong>: The attribute separator character (i.e., ";"). Used only for logfiles.
    </li> 
    
  
    <li>
	  <strong>subject</strong>: The TerraME object that will be observed.
    </li> 
    
  
    <li>
	  <strong>title</strong>: An overall title to the observer.
    </li> 
    
  
    <li>
	  <strong>type</strong>: A string to define the way to observe a given object. See the table below.
    </li> 
    
      </span>
      <!-- Strategy of the parameter -->
       
      <table class="param_tab">
	  
      
        <tr>
        
          
            <th>
            Type
            </th>
          
          
            <th>
            Description
            </th>
          
          
            <th>
            Compulsory parameters
            </th>
          
          
            <th>
            Optional parameters
            </th>
          
        
        <tr>
        
          
            <td>
            "chart"
            </td>
          
          
            <td>
            Create a line chart showing the variation of one or more attributes (y axis) of an object. X axis values come from the single argument of notify().
            </td>
          
          
            <td>
            attributes, subject
            </td>
          
          
            <td>
            curveLabels, title, xLabel, xaxis, yLabel
            </td>
          
        
        <tr>
        
          
            <td>
            "image"
            </td>
          
          
            <td>
            Create a map with the spatial distribution of a given <a href=../files/Agent.html>Agent</a>, <a href=../files/CellularSpace.html>CellularSpace</a>, <a href=../files/Society.html>Society</a> or <a href=../files/Trajectory.html>Trajectory</a>, saving it in a png file for each notify(). It works in the same way of the observer map.
            </td>
          
          
            <td>
            attributes, subject
            </td>
          
          
            <td>
            file, legends
            </td>
          
        
        <tr>
        
          
            <td>
            "logfile"
            </td>
          
          
            <td>
            Save attributes of an object into a csv text file, with one row for each notify().
            </td>
          
          
            <td>
            attributes, file, separator, subject
            </td>
          
          
            <td>
            
            </td>
          
        
        <tr>
        
          
            <td>
            "map"
            </td>
          
          
            <td>
            Create a map with the spatial distribution of a given CellularSpace, Trajectory, Agent, or Society. It draws each element into the screen, according to one or two attributes (two is allowed only for CellularSpace) colored from one or two Legends, respectively. The second attribute and Legend are used as background.
            </td>
          
          
            <td>
            attributes, legends, observer (unless when the subject is a CellularSpace), subject
            </td>
          
          
            <td>
            
            </td>
          
        
        <tr>
        
          
            <td>
            "neighborhood"
            </td>
          
          
            <td>
            Draw the <a href=../files/Neighborhood.html>Neighborhood</a> of a Cell, or the Neighborhoods of each Cell within a Trajectory, CellularSpace, or <a href=../files/Environment.html>Environment</a>. They are drawn as lines, according to a neighType.
            </td>
          
          
            <td>
            observer, subject
            </td>
          
          
            <td>
            neighIndex, neighType
            </td>
          
        
        <tr>
        
          
            <td>
            "scheduler"
            </td>
          
          
            <td>
            Create a display with the current time and <a href=../files/Event.html>Event</a> queue of a given <a href=../files/Timer.html>Timer</a>.
            </td>
          
          
            <td>
            subject
            </td>
          
          
            <td>
            
            </td>
          
        
        <tr>
        
          
            <td>
            "statemachine"
            </td>
          
          
            <td>
            Draw the state machine of an Automaton in a Cell or an Agent. As default, states are drawn as gray circles with a green circle to represent the current state. Unique value Legends can be used to map state names to colors, putting the current state in evidence with bold font.
            </td>
          
          
            <td>
            legends, location (only when the subject is an Automaton), subject
            </td>
          
          
            <td>
            
            </td>
          
        
        <tr>
        
          
            <td>
            "table"
            </td>
          
          
            <td>
            Display a table with the current attributes of an object. Each notify() overwrites the previous values.
            </td>
          
          
            <td>
            attributes, subject
            </td>
          
          
            <td>
            
            </td>
          
        
        <tr>
        
          
            <td>
            "textscreen"
            </td>
          
          
            <td>
            Create a display in a tabular format with the current attributes of an object. It will have one row for each notify().
            </td>
          
          
            <td>
            attributes, subject
            </td>
          
          
            <td>
            
            </td>
          
        
        <tr>
        
          
            <td>
            "udpsender"
            </td>
          
          
            <td>
            Send observed attributes of an object through a UDP port of a given IP.
            </td>
          
          
            <td>
            attributes, host, port, subject
            </td>
          
          
            <td>
            
            </td>
          
          
            <td>
            
            </td>
          
        
        <tr>
        
          
            <td>
            
            </td>
          
        
        </tr>    
      </table>
      <span class="param">
    
  
    <li>
	  <strong>xLabel</strong>: Name of the x-axis. It does not show any label as default.
    </li> 
    
  
    <li>
	  <strong>xaxis</strong>: A string representing the attribute to be used as x axis in a chart observer. When nil, time will be used as axis.
    </li> 
    
  
    <li>
	  <strong>yLabel</strong>: Name of the y-axis. It does not show any label as default.
    </li> 
    
  
  </span></ul>







<h3>Usage</h3>
<pre class="example"><code><span class="id">observer1</span> = <span class="function">Observer</span> {
    <span class="id">subject</span> = <span class="id">cs</span>,
    <span class="id">attributes</span> = <span class="string">"water"</span>,
    <span class="id">legends</span> = {<span class="id">soilWaterLeg</span>}
}

<span class="function">Observer</span> {
    <span class="id">subject</span> = <span class="id">trajectory</span>,
    <span class="id">observer</span> = <span class="id">observer</span>
}

<span class="id">observer3</span> = <span class="function">Observer</span> {
    <span class="id">subject</span> = <span class="id">cell</span>,
    <span class="function">type</span> = <span class="string">"chart"</span>,
    <span class="id">attributes</span> = {<span class="string">"water"</span>}
}</code></pre>



</dd>



</table>





<!--<br/>
<br/>-->








</div> <!-- id="content" -->

</div> <!-- id="main" -->

<div id="about">
	<p><a href="http://validator.w3.org/check?uri=referer"><img src="http://www.w3.org/Icons/valid-xhtml10" alt="Valid XHTML 1.0!" height="31" width="88" /></a></p>
</div> <!-- id="about" -->

</div> <!-- id="container" -->	
</body>
</html>
