<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
    <title>Reference</title>
    <link rel="stylesheet" href="../luadoc.css" type="text/css" />
	<!--meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/-->
</head>

<body>
<div id="container">

<div id="product">
	<div id="product_logo"><img src='../img/terrame.png'/><br/></div>
	<div id="product_name"><big><b></b></big></div>
	<div id="product_description"></div>
</div> <!-- id="product" -->

<div id="main">

<div id="navigation">


<h1>TerraME</h1>
<ul>
	
	<li><a href="../index.html">Index</a></li>
	
</ul>


<!-- Module list -->



<!-- Types list -->

<h1>Types</h1>
<ul>

		<li>
			<a href="../files/Agent.html">Agent</a>
		</li>
		
	

		<li>
			<a href="../files/Automaton.html">Automaton</a>
		</li>
		
	

		<li>
			<a href="../files/Cell.html">Cell</a>
		</li>
		
	

		<li>
			<a href="../files/CellularSpace.html">CellularSpace</a>
		</li>
		
	

		<li>
			<a href="../files/Coord.html">Coord</a>
		</li>
		
	

		<li>
			<a href="../files/Environment.html">Environment</a>
		</li>
		
	

		<li>
			<a href="../files/Event.html">Event</a>
		</li>
		
	

		<li>
			<a href="../files/Flow.html">Flow</a>
		</li>
		
	

		<li>
			<a href="../files/Group.html">Group</a>
		</li>
		
	

		<li>
			<a href="../files/Jump.html">Jump</a>
		</li>
		
	

		<li>
			<a href="../files/Legend.html">Legend</a>
		</li>
		
	

		<li>
			<a href="../files/Neighborhood.html">Neighborhood</a>
		</li>
		
	

		<li>
			<a href="../files/Observer.html">Observer</a>
		</li>
		
	

		<li>
			<a href="../files/Random.html">Random</a>
		</li>
		
	

		<li>
			<a href="../files/SocialNetwork.html">SocialNetwork</a>
		</li>
		
	

		<li><strong>Society</strong></li>
		
	

		<li>
			<a href="../files/State.html">State</a>
		</li>
		
	

		<li>
			<a href="../files/Timer.html">Timer</a>
		</li>
		
	

		<li>
			<a href="../files/Trajectory.html">Trajectory</a>
		</li>
		
	


</ul>


<!-- Files list -->

<h1>Files</h1>
<ul>




















		<li>
			<a href="../files/Utils.html">Utils</a>
		</li>
		
	

</ul>


</div> <!-- id="navigation" -->

<div id="content">

<h1><code>Society



</code></h1>


<span class="description"></span>









<span class="description">Type to create and manipulate a set of <a href=../files/Agent.html>Agents</a>. Each Agent within a Society has a unique id, which is initialized while creating the Society. There are three ways to create a Society: the first one uses a "quantity" to indicate the number of copies of the instance to be created. The second uses "data" with positions representing basic attributes of each Agent to be created. The last one uses a "layer" from a database to load attributes to the Agents. Calling <a href=../files/Utils.html#forEachAgent>forEachAgent()</a> traverses Societies. Societies have additional functions related to its instance, according to the table below.</span>


	 
			<table class="param_tab">
			
				<tr>
					
							<th>
							Attribute of instance
							</th>
						
							<th>
							Function within the Society
							</th>
						
				<tr>
					
							<td>
							function
							</td>
						
							<td>
							Call the function of each of its Agents
							</td>
						
				<tr>
					
							<td>
							number
							</td>
						
							<td>
							Return the sum of the number in each of its Agents
							</td>
						
				<tr>
					
							<td>
							boolean
							</td>
						
							<td>
							Return the sum of true values in each of its Agents
							</td>
						
				<tr>
					
							<td>
							string
							</td>
						
							<td>
							Return a table with positions equal to the unique strings and values equal to the number of occurrences in each of its Agents
							</td>
						
				</tr>    
			</table>
		


<!-- Function parameters -->
  <h3>Parameters</h3>
<ul><span class="param">

    <li>
	  <strong>database</strong>: Name of the database.
    </li> 
    
  
    <li>
	  <strong>dbType</strong>: Name of DBMS. The default value depends on the database name. If it has a ".mdb" extension, the default value is "ado", otherwise it is "mysql"). TerraME always converts this string to lower case.
    </li> 
    
  
    <li>
	  <strong>file</strong>: A filename (.csv) where the Society is stored.
    </li> 
    
  
    <li>
	  <strong>host</strong>: Host where the database is stored (default is "localhost").
    </li> 
    
  
    <li>
	  <strong>id</strong>: The unique identifier attribute used when reading the Society from a file.
    </li> 
    
  
    <li>
	  <strong>instance</strong>: A table with the description of the attributes and functions of an Agent. Some functions that may have internal TerraME use are:
    </li> 
    
      </span>
      <!-- Strategy of the parameter -->
       
      <table class="param_tab">
	  
      
        <tr>
        
          
            <th>
            Function
            </th>
          
          
            <th>
            Description
            </th>
          
        
        <tr>
        
          
            <td>
            execute(self)
            </td>
          
          
            <td>
            A function with the behavior of the Agent when activated.
            </td>
          
        
        <tr>
        
          
            <td>
            init(self)
            </td>
          
          
            <td>
            A function called at the end of the instantiation process.
            </td>
          
        
        <tr>
        
          
            <td>
            on_*(self, message)
            </td>
          
          
            <td>
            A function called when the Agent receives a message. See <a href=../files/Agent.html#message>Agent:message()</a> for more details.
            </td>
          
        
        <tr>
        
          
            <td>
            
            </td>
          
        
        </tr>    
      </table>
      <span class="param">
    
  
    <li>
	  <strong>layer</strong>: Name of the layer the theme was created from. It must be used to solve a conflict when there are two themes with the same name (default is "").
    </li> 
    
  
    <li>
	  <strong>password</strong>: The password (default is "").
    </li> 
    
  
    <li>
	  <strong>port</strong>: Port number of the connection.
    </li> 
    
  
    <li>
	  <strong>quantity</strong>: Number of Agents to be created. It is used when the Society will not be loaded from a file or database.
    </li> 
    
  
    <li>
	  <strong>select</strong>: A table containing the names of the attributes to be retrieved (default is all attributes). When retrieving a single attribute, you can use select = "attribute" instead of select = {"attribute"}. It is possible to rename the attribute name using "as", for example, select = {"lc as landcover"} reads lc from the database but replaces the name to landcover in the <a href=../files/Cell.html>Cells</a>.
    </li> 
    
  
    <li>
	  <strong>theme</strong>: Name of the theme to be loaded.
    </li> 
    
  
    <li>
	  <strong>user</strong>: Username (default is "").
    </li> 
    
  
    <li>
	  <strong>where</strong>: A SQL restriction on the properties of the Agents (default is "", applying no restriction. Only the Agents that reflect the established criteria will be loaded). This argument ignores the "as" flexibility of select. 
    </li> 
    
  
  </span></ul>



<!-- Outputs of the function -->
<p>Attributes of Society that can be used as <b>read-only</b> by the modeler:</p>
<ul>
<span class="output">
	
	<li>
	  <strong>agents</strong>: A vector of Agents pointed by the Society.
	</li>
	
	<li>
	  <strong>autoincrement</strong>: unique identifier used to represent the last Agent added to the Society. The next Agent will have 'autoincrement+1' as id.
	</li>
	
	<li>
	  <strong>instance</strong>: A function used to build the Agent.
	</li>
	
	<li>
	  <strong>messages</strong>: A vector that contains the delayed messages.
	</li>
	
	<li>
	  <strong>parent</strong>: The <a href=../files/Environment.html>Environment</a> it belongs. 
	</li>
	
</span>
</ul>





<h3>Usage</h3>
<pre class="example"><code><span class="id">my_instance</span> = <span class="function">Agent</span> {
    <span class="function">execute</span> = <span class="reserved">function</span>(...),
    <span class="id">run</span> = <span class="reserved">function</span>(...),
    <span class="id">age</span> = <span class="number">0</span>
}

<span class="id">s</span> = <span class="function">Society</span> {
    <span class="id">instance</span> = <span class="id">my_instance</span>,
    <span class="id">quantity</span> = <span class="number">20</span>
}

<span class="id">s</span>:<span class="function">execute</span>() <span class="comment">-- call execute for each agent</span>
<span class="id">s</span>:<span class="id">run</span>() <span class="comment">-- call run for each agent</span>
<span class="id">print</span>(<span class="id">s</span>:<span class="id">age</span>()) <span class="comment">-- sum of the ages of each agent</span>

<span class="id">s</span> = <span class="function">Society</span> {
    <span class="id">instance</span> = <span class="id">my_instance</span>,
    <span class="id">database</span> = <span class="string">"c:\\datab.mdb"</span>,
    <span class="id">layer</span> = <span class="string">"farmers"</span>
}

<span class="id">s</span> = <span class="function">Society</span> {
    <span class="id">instance</span> = <span class="id">my_instance</span>,
    <span class="id">database</span> = <span class="string">"file.csv"</span>
}</code></pre>



</dd>



<h2 class="function_list">Functions</h2>
<table class="function_list">

	  <tr>
		<td class="name" nowrap><a href="#add">add</a>&nbsp;
	  <td class="summary">Add a new Agent to the Society.</td>
    </tr>

	  <tr>
		<td class="name" nowrap><a href="#clear">clear</a>&nbsp;
	  <td class="summary">Remove all the Agents from the Society.</td>
    </tr>

	  <tr>
		<td class="name" nowrap><a href="#createSocialNetwork">createSocialNetwork</a>&nbsp;
	  <td class="summary">Create a directed SocialNetwork for each Agent of the Society.</td>
    </tr>

	  <tr>
		<td class="name" nowrap><a href="#getAgent">getAgent</a>&nbsp;
	  <td class="summary">Return a given Agent based on its index.</td>
    </tr>

	  <tr>
		<td class="name" nowrap><a href="#getAgents">getAgents</a>&nbsp;
	  <td class="summary">Return a vector with the Agents of the Society.</td>
    </tr>

	  <tr>
		<td class="name" nowrap><a href="#notify">notify</a>&nbsp;
	  <td class="summary">Notify all the Agents of the Society.</td>
    </tr>

	  <tr>
		<td class="name" nowrap><a href="#remove">remove</a>&nbsp;
	  <td class="summary">Remove a given Agent from the Society.</td>
    </tr>

	  <tr>
		<td class="name" nowrap><a href="#sample">sample</a>&nbsp;
	  <td class="summary">Return a random Agent from the Society.</td>
    </tr>

	  <tr>
		<td class="name" nowrap><a href="#split">split</a>&nbsp;
	  <td class="summary">Split the Society into a set of Groups according to a classification strategy.</td>
    </tr>

	  <tr>
		<td class="name" nowrap><a href="#synchronize">synchronize</a>&nbsp;
	  <td class="summary">Activate each asynchronous message sent by Agents belonging to the Society.</td>
    </tr>

	  <tr>
		<td class="name" nowrap><a href="##">#</a>&nbsp;
	  <td class="summary">Return the number of Agents of the Society.</td>
    </tr>


</table>





<!--<br/>
<br/>-->




	
<dl class="function">



<dt><h2><a name="add">
</a><strong>add</strong>&nbsp;
</h2></dt>
<dd>

<span class="description">Add a new <a href=../files/Agent.html>Agent</a> to the Society.</span>




<!-- Function parameters -->
  <h3>Parameters</h3>
<ul><span class="param">

    <li>
	  <strong>1st</strong>: The new Agent that will be added to the Society. If nil, the Soceity will add a copy of the instance used to build the Society. In this case, the Society executes <a href=../files/Agent.html#init>Agent:init()</a> after creating the copy.
    </li> 
    
  
  </span></ul>







<h3>Usage</h3>
<pre class="example"><code><span class="id">soc</span>:<span class="function">add</span>(<span class="id">agent</span>)</code></pre>



<h3>See also</h3>
<ul>
	
	<li>
		
			<a href="../files/Agent.html#init">Agent:init	</a>
		
	</li>
	
</ul>

</dd>

    



<dt><h2><a name="clear">
</a><strong>clear</strong>&nbsp;
</h2></dt>
<dd>

<span class="description">Remove all the <a href=../files/Agent.html>Agents</a> from the Society.</span>










<h3>Usage</h3>
<pre class="example"><code><span class="id">soc</span>:<span class="function">clear</span>()</code></pre>



</dd>

    



<dt><h2><a name="createSocialNetwork">
</a><strong>createSocialNetwork</strong>&nbsp;
</h2></dt>
<dd>

<span class="description">Create a directed <a href=../files/SocialNetwork.html>SocialNetwork</a> for each <a href=../files/Agent.html>Agent</a> of the Society. The following arguments represent the strategies, which must be only one for call:</span>


	


<!-- Function parameters -->
  <h3>Parameters</h3>
<ul><span class="param">

    <li>
	  <strong>func</strong>: A function (Agent, Agent) -> boolean that returns true if the first Agent will have the second Agent in its SocialNetwork. When using this argument, the default value of strategy becomes "func".
    </li> 
    
  
    <li>
	  <strong>name</strong>: Name of the relation.
    </li> 
    
  
    <li>
	  <strong>neighborhood</strong>: A string with the index of the <a href=../files/Neighborhood.html>Neighborhood</a> that will be used to compute the network.
    </li> 
    
  
    <li>
	  <strong>probability</strong>: A number between 0 and 1 indicating the probability of each connection. The probability is applied for each pair of Agents. When using this argument, the default value of strategy becomes "probability".
    </li> 
    
  
    <li>
	  <strong>quantity</strong>: A number indicating the number of connections each Agent will have, taking randomly from the whole Society. When using this argument, the default value of strategy becomes "quantity".
    </li> 
    
  
    <li>
	  <strong>self</strong>: A boolean value indicating whether the Agent can be connected to itself. Default is false.
    </li> 
    
  
    <li>
	  <strong>strategy</strong>: A string with the strategy to be used for creating the SocialNetwork. See the table below.
    </li> 
    
      </span>
      <!-- Strategy of the parameter -->
       
      <table class="param_tab">
	  
      
        <tr>
        
          
            <th>
            Strategy
            </th>
          
          
            <th>
            Description
            </th>
          
          
            <th>
            Compulsory parameters
            </th>
          
          
            <th>
            Optional parameters
            </th>
          
        
        <tr>
        
          
            <td>
            "cell"
            </td>
          
          
            <td>
            Create a dynamic SocialNetwork for each Agent of the Society with every Agent within the same <a href=../files/Cell.html>Cell</a> the Agent belongs.
            </td>
          
          
            <td>
            
            </td>
          
          
            <td>
            name, self
            </td>
          
        
        <tr>
        
          
            <td>
            "func"
            </td>
          
          
            <td>
            Create a SocialNetwork according to a membership function.
            </td>
          
          
            <td>
            func
            </td>
          
          
            <td>
            name
            </td>
          
        
        <tr>
        
          
            <td>
            "neighbor"
            </td>
          
          
            <td>
            Create a dynamic SocialNetwork for each Agent of the Society with every Agent within the neighbor Cells of the one the Agent belongs.
            </td>
          
          
            <td>
            
            </td>
          
          
            <td>
            name, neighborhood
            </td>
          
        
        <tr>
        
          
            <td>
            "probability"
            </td>
          
          
            <td>
            Applies a probability for each pair of Agents.
            </td>
          
          
            <td>
            probability
            </td>
          
          
            <td>
            name, self
            </td>
          
        
        <tr>
        
          
            <td>
            "quantity"
            </td>
          
          
            <td>
            Number of connections randomly taken from the Society.
            </td>
          
          
            <td>
            quantity
            </td>
          
          
            <td>
            name, self
            </td>
          
        
        <tr>
        
          
            <td>
            "void"
            </td>
          
          
            <td>
            Create an empty SocialNetwork for each Agent of the Society.
            </td>
          
          
            <td>
            name, self
            </td>
          
          
            <td>
            
            </td>
          
        
        </tr>    
      </table>
      <span class="param">
    
  
  </span></ul>







<h3>Usage</h3>
<pre class="example"><code><span class="id">soc</span>:<span class="function">createSocialNetwork</span> {
    <span class="id">quantity</span> = <span class="number">2</span>
}

<span class="id">soc</span>:<span class="function">createSocialNetwork</span> {
    <span class="id">probability</span> = <span class="number">0</span><span class="number">.15</span>
    <span class="id">name</span> = <span class="string">"random"</span>
}

<span class="id">soc</span>:<span class="function">createSocialNetwork</span> {
   <span class="id">neighbor</span> = <span class="string">"1"</span>
   <span class="id">name</span> = <span class="string">"byneighbor"</span>
}</code></pre>



</dd>

    



<dt><h2><a name="getAgent">
</a><strong>getAgent</strong>&nbsp;
</h2></dt>
<dd>

<span class="description">Return a given <a href=../files/Agent.html>Agent</a> based on its index.</span>




<!-- Function parameters -->
  <h3>Parameters</h3>
<ul><span class="param">

    <li>
	  <strong>1st</strong>: The index of the Agent that will be returned.
    </li> 
    
  
  </span></ul>







<h3>Usage</h3>
<pre class="example"><code><span class="id">agent</span> = <span class="id">soc</span>:<span class="function">getAgent</span>(<span class="string">"1"</span>)</code></pre>



</dd>

    



<dt><h2><a name="getAgents">
</a><strong>getAgents</strong>&nbsp;
</h2></dt>
<dd>

<span class="description">Return a vector with the <a href=../files/Agent.html>Agents</a> of the Society.</span>










<h3>Usage</h3>
<pre class="example"><code><span class="id">agent</span> = <span class="id">soc</span>:<span class="function">getAgents</span>()[<span class="number">1</span>]</code></pre>



</dd>

    



<dt><h2><a name="notify">
</a><strong>notify</strong>&nbsp;
</h2></dt>
<dd>

<span class="description">Notify all the <a href=../files/Agent.html>Agents</a> of the Society.</span>




<!-- Function parameters -->
  <h3>Parameters</h3>
<ul><span class="param">

    <li>
	  <strong>1st</strong>: The notification time.
    </li> 
    
  
  </span></ul>







<h3>Usage</h3>
<pre class="example"><code><span class="id">society</span>:<span class="function">notify</span>()</code></pre>



</dd>

    



<dt><h2><a name="remove">
</a><strong>remove</strong>&nbsp;
</h2></dt>
<dd>

<span class="description">Remove a given <a href=../files/Agent.html>Agent</a> from the Society. It returns whether the agent was sucessfully removed.</span>




<!-- Function parameters -->
  <h3>Parameters</h3>
<ul><span class="param">

    <li>
	  <strong>1st</strong>: The Agent that will be removed.
    </li> 
    
  
  </span></ul>







<h3>Usage</h3>
<pre class="example"><code><span class="id">soc</span>:<span class="function">remove</span>(<span class="id">agent</span>)</code></pre>



</dd>

    



<dt><h2><a name="sample">
</a><strong>sample</strong>&nbsp;
</h2></dt>
<dd>

<span class="description">Return a random <a href=../files/Agent.html>Agent</a> from the Society.</span>




<!-- Function parameters -->
  <h3>Parameters</h3>
<ul><span class="param">

    <li>
	  <strong>1st</strong>: A random object.
    </li> 
    
  
  </span></ul>







<h3>Usage</h3>
<pre class="example"><code><span class="id">agent</span> = <span class="id">soc</span>:<span class="function">sample</span>()</code></pre>



</dd>

    



<dt><h2><a name="split">
</a><strong>split</strong>&nbsp;
</h2></dt>
<dd>

<span class="description">Split the Society into a set of <a href=../files/Group.html>Groups</a> according to a classification strategy. The generated Groups have empty intersection and union equals to the whole <a href=../files/CellularSpace.html>CellularSpace</a> (unless function below returns nil for some <a href=../files/Agent.html>Agent</a>). It works according to the type of its only and compulsory argument, that can be:</span>


	


<!-- Function parameters -->
  <h3>Parameters</h3>
<ul><span class="param">

    <li>
	  <strong>1st</strong>: string or function 
    </li> 
    
      </span>
      <!-- Strategy of the parameter -->
       
      <table class="param_tab">
	  
      
        <tr>
        
          
            <th>
            Type of argument
            </th>
          
          
            <th>
            Description
            </th>
          
        
        <tr>
        
          
            <td>
            string
            </td>
          
          
            <td>
            The argument must represent the name of one attribute of the Agents of the Society. Split then creates one Group for each possible value of the attribute using the value as index and fills them with the Agents that have the respective attribute value.
            </td>
          
        
        <tr>
        
          
            <td>
            function
            </td>
          
          
            <td>
            The argument is a function that receives an Agent as argument and returns a value with the index that contains the Agent. Groups are then indexed according to the returning value.
            </td>
          
        
        <tr>
        
          
            <td>
            
            </td>
          
        
        </tr>    
      </table>
      <span class="param">
    
  
  </span></ul>







<h3>Usage</h3>
<pre class="example"><code><span class="id">gs</span> = <span class="id">soc</span>:<span class="function">split</span>(<span class="string">"gender"</span>)
<span class="id">print</span>(#<span class="id">gs</span>.<span class="id">male</span>)
<span class="id">print</span>(#<span class="id">gs</span>.<span class="id">female</span>)

<span class="id">gs2</span> = <span class="id">soc</span>:<span class="function">split</span>(<span class="reserved">function</span>(<span class="id">ag</span>)
    <span class="reserved">if</span> <span class="id">ag</span>.<span class="id">age</span> > <span class="number">60</span> <span class="reserved">then</span> 
        <span class="reserved">return</span> <span class="string">"old"</span> 
    <span class="reserved">else</span> 
        <span class="reserved">return</span> <span class="string">"notold"</span> 
    <span class="reserved">end</span>
<span class="reserved">end</span>)
<span class="id">print</span>(#<span class="id">ts</span>.<span class="id">old</span>)</code></pre>



</dd>

    



<dt><h2><a name="synchronize">
</a><strong>synchronize</strong>&nbsp;
</h2></dt>
<dd>

<span class="description">Activate each asynchronous message sent by <a href=../files/Agent.html>Agents</a> belonging to the Society.</span>




<!-- Function parameters -->
  <h3>Parameters</h3>
<ul><span class="param">

    <li>
	  <strong>1st</strong>: A number indicating the current delay to be delivered. Messages with delay less or equal this value are sent, while the others have their delays reduced by this value. Default is one.
    </li> 
    
  
  </span></ul>







<h3>Usage</h3>
<pre class="example"><code><span class="id">soc</span>:<span class="function">synchronize</span>()
<span class="id">soc</span>:<span class="function">synchronize</span>(<span class="number">2</span>)</code></pre>



</dd>

    



<dt><h2><a name="#">
</a><strong>#</strong>&nbsp;
</h2></dt>
<dd>

<span class="description">Return the number of <a href=../files/Agent.html>Agents</a> of the Society.</span>










<h3>Usage</h3>
<pre class="example"><code><span class="id">print</span>(#<span class="id">soc</span>)</code></pre>



</dd>

    

</dl>





</div> <!-- id="content" -->

</div> <!-- id="main" -->

<div id="about">
	<p><a href="http://validator.w3.org/check?uri=referer"><img src="http://www.w3.org/Icons/valid-xhtml10" alt="Valid XHTML 1.0!" height="31" width="88" /></a></p>
</div> <!-- id="about" -->

</div> <!-- id="container" -->	
</body>
</html>
